---
layout:     post
title:      Geth æ·±åº¦å®æˆ˜ï¼šä»é›¶å¼€å§‹è¿è¡Œå¹¶ä¼˜åŒ–ä»¥å¤ªåŠèŠ‚ç‚¹
date:       2025-09-05
header-img: img/post-bg-desk.jpg
catalog: true
---

> æ ¸å¿ƒå…³é”®è¯ï¼šGethã€ä»¥å¤ªåŠèŠ‚ç‚¹ã€åŒºå—é“¾åŒæ­¥ã€èŠ‚ç‚¹é…ç½®ã€ä»¥å¤ªåŠå®¢æˆ·ç«¯ã€PoS å…±è¯†ã€èŠ‚ç‚¹ç›‘æ§ã€Go Ethereum

Gethï¼ˆGo Ethereumï¼‰æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„ä»¥å¤ªåŠå®¢æˆ·ç«¯ä¹‹ä¸€ã€‚å®ƒä»¥ Go è¯­è¨€ç¼–å†™ï¼Œæ—¢è½»é‡åˆé«˜æ•ˆï¼Œé€‚åˆä¸ªäººå¼€å‘è€…ã€ç ”ç©¶æœºæ„ä¸åŸºç¡€è®¾æ–½æä¾›å•†ä½¿ç”¨ã€‚æœ¬æ–‡å°†å›´ç»•â€œå¦‚ä½•æ­£ç¡®å®‰è£…ã€é…ç½®å¹¶é•¿æœŸç»´æŠ¤ Geth ä»¥å¤ªåŠèŠ‚ç‚¹â€å±•å¼€ï¼Œç»“åˆæœ€ä½³å®è·µä¸å¸¸è§å‘ï¼Œå¸®åŠ©ä½ åœ¨æœ€çŸ­çš„æ—¶é—´å†…è·‘å‡ºä¸€æ¡ç¨³å®šã€å®‰å…¨ä¸”é«˜æ€§èƒ½çš„èŠ‚ç‚¹ã€‚

---

## ä¸ºä»€ä¹ˆ Geth ä»æ˜¯æ–°æ‰‹é¦–é€‰ï¼Ÿ

1. **è·¨å¹³å°**ï¼šæ”¯æŒ Windowsã€macOSã€ä¸»æµ Linux å‘è¡Œç‰ˆï¼Œç”šè‡³èƒ½åœ¨ ARM æ¿å­ä¸Šè·‘ã€‚
2. **ç”Ÿæ€ä¸°å¯Œ**ï¼šå®˜æ–¹é•¿æœŸç»´æŠ¤ï¼Œç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£é½å…¨ã€‚
3. **å¯ç¼–ç¨‹æ‰©å±•**ï¼šæä¾› JSON-RPCã€GraphQL ä¸å…¨æ–° `engine API`ï¼Œå¯æ— ç¼æ¥å…¥ Layer2ã€é’±åŒ…ã€é“¾åˆ†æå·¥å…·ã€‚

ğŸ‘‰ [ä¸‰åˆ†é’Ÿä½“éªŒä¸€é”®éƒ¨ç½² Geth ä¸»ç½‘èŠ‚ç‚¹æœ€æ–°è„šæœ¬](https://okxdog.com/)

---

## å‰æœŸå‡†å¤‡ï¼šç¡¬ä»¶ä¸ç³»ç»Ÿ

| ç»´åº¦   | æœ€ä½è¦æ±‚             | æ¨èé…ç½®            | å…³é”®è¯æç¤º |
| ------ | -------------------- | ------------------- | ---------- |
| CPU    | 4 çº¿ç¨‹                | 8 çº¿ç¨‹ + AVX2       | ä»¥å¤ªåŠèŠ‚ç‚¹æ€§èƒ½ |
| RAM    | 8 GB                 | 16 GB ä»¥ä¸Š          | Geth å†…å­˜å ç”¨ |
| SSD    | 1 TB SATA            | 2 TB NVMe           | åŒºå—é“¾åŒæ­¥é€Ÿåº¦ |
| å¸¦å®½   | 10 Mbps ä¸Š/ä¸‹è¡Œ      | 100 Mbps ä¸Š/ä¸‹è¡Œ    | åŒºå—å¹¿æ’­å»¶è¿Ÿ |
| ç³»ç»Ÿ   | Ubuntu 20.04+ LTS    | Debian/Ubuntu ç³»    | å¸¸è§é…ç½®å‘  |

> æç¤ºï¼šå¦‚æœä½ è®¡åˆ’åœ¨ 2025 å¹´ä¹‹ååŒæ­¥å…¨èŠ‚ç‚¹ï¼Œå»ºè®®ç›´æ¥é¢„ç•™ 3 TB SSDï¼›ä¸Šæµ·å‡çº§åçŠ¶æ€æ•°æ®è†¨èƒ€æ˜æ˜¾ã€‚

---

## å®‰è£… Geth çš„ä¸‰ç§å§¿åŠ¿

### 1. å®˜æ–¹äºŒè¿›åˆ¶åŒ…ï¼ˆæœ€å¹²å‡€ï¼‰

```bash
# ä»¥ Ubuntu ä¸ºä¾‹
wget https://gethstore.blob.core.windows.net/builds/geth-linux-amd64-1.14.0-unstable.tar.gz
tar -xzf geth-linux-amd64-1.14.0-unstable.tar.gz
sudo cp geth-linux-amd64-1.14.0-unstable/geth /usr/local/bin/
```

### 2. PPA å¿«é€Ÿè·¯çº¿

```bash
sudo add-apt-repository ppa:ethereum/ethereum
sudo apt-get update
sudo apt-get install ethereum
```

### 3. Docker ç¬”è®°â€”â€”é€‚åˆCI/CD

```bash
docker pull ethereum/client-go:v1.14.0
```

ä»»ä½•ä¸€ç§æ–¹å¼è£…å¥½åï¼Œæ‰§è¡Œ `geth version` èƒ½çœ‹åˆ° `Go Ethereum` å­—æ ·å³ä¸ºæˆåŠŸã€‚

---

## é…ç½®è¯¦è§£ï¼šä¸€åˆ†é’Ÿçœ‹æ‡‚ config.toml å…³é”®å­—æ®µ

åˆ›å»º `~/geth/config.toml`ï¼ˆæˆ–ä½ å–œæ¬¢çš„è·¯å¾„ï¼‰ï¼Œæ ¸å¿ƒå…ƒç´ å¦‚ä¸‹ï¼š

```toml
[Eth]
NetworkId = 1      # ä¸»ç½‘
SyncMode = "snap"  # å¿«ç…§åŒæ­¥ï¼ŒèŠ‚çº¦ 90% æ—¶é—´
NoPruning = false  # å…¨èŠ‚ç‚¹æ¨¡å¼ä¸å¯å…³
EnablePreimageRecording = false   # æ—¥å¸¸ç”¨ä¸åˆ°ï¼Œå¼€å¯ä¼šæ‹–æ…¢ç£ç›˜

[Node]
DataDir = "/mnt/ethereum/geth"
HTTPHost = "0.0.0.0"
HTTPPort = 8545
HTTPModules = ["eth", "net", "web3", "txpool"]

[Node.P2P]
MaxPeers = 50
NoDiscovery = false
BootstrapNodes = ["enode://...å®˜æ–¹å¼•å¯¼èŠ‚ç‚¹..."]
```

ä¸€æ—¦ä¿å­˜å®Œï¼Œå³å¯é€šè¿‡ï¼š

```bash
geth --config ~/geth/config.toml
```

å¯åŠ¨ä¸»ç½‘åŒæ­¥ã€‚è‹¥æƒ³æµ‹è¯•ç½‘ç»ƒæ‰‹ï¼Œä»…éœ€æ›¿æ¢ `NetworkId = 5`ï¼ˆGoerliï¼‰ã€‚

---

## å¯åŠ¨ä¸é¦–æ¬¡åŒæ­¥çš„ 4 ä¸ªé˜¶æ®µ

1. **P2P æ¡æ‰‹**ï¼šèŠ‚ç‚¹ä¼šå¯»æ‰¾å¯¹ç­‰èŠ‚ç‚¹ï¼Œæ—¥å¿—è¾“å‡º `Looking for peers`ã€‚
2. **åå‘å¤´åŒæ­¥**ï¼šå¿«é€Ÿæ‹¿åˆ°æœ€æ–°åŒºå—å¤´ï¼Œè€—æ—¶åˆ†é’Ÿçº§ã€‚
3. **çŠ¶æ€ä¸‹è½½ï¼ˆsnapï¼‰**ï¼šæœ€åƒ I/O çš„ä¸€æ­¥ï¼Œæ•°å°æ—¶åˆ°ä¸€å¤©ä¸ç­‰ï¼Œè§† SSD æ€§èƒ½ã€‚
4. **é“¾éªŒè¯**ï¼šéšæœºæŠ½æŸ¥å†å²çŠ¶æ€ï¼Œç¡®ä¿æ•°æ®æœªè¢«ç¯¡æ”¹ã€‚

å°æŠ€å·§ï¼šåŒæ­¥æ—¶å¯åŠ  `--cache=4096` æé«˜å†…å­˜ç¼“å­˜ï¼ŒCPU å ç”¨æ˜¾è‘—ä¸‹é™ã€‚

---

## Q&Aï¼šæ–°ä¸Šæ‰‹çš„å¿…é—®æ¸…å•

**Q1: åŒæ­¥ 1 å¤©è¿˜æ²¡å®Œï¼Œæ­£å¸¸å—ï¼Ÿ**  
Aï¼šç½‘ç»œ/ç£ç›˜æ²¡é—®é¢˜å³ä¸ºå¸¸æ€ï¼›Goerli å¯èƒ½éœ€ 4-6 å°æ—¶ï¼Œä¸»ç½‘ 6-24 å°æ—¶ã€‚

**Q2: å¦‚ä½•ç¡®å®šçœŸçš„åŒæ­¥å®Œæˆï¼Ÿ**  
Aï¼šæ—¥å¿—å‡ºç° `Imported new chain segment` ä¸”å—é«˜ç­‰äº [Etherscan](https://etherscan.io) æœ€æ–°å³å¯ã€‚

**Q3: èƒ½ç”¨æœºæ¢°ç¡¬ç›˜å—ï¼Ÿ**  
Aï¼šæ…¢åˆ°æ€€ç–‘äººç”Ÿï¼ŒSSD æ˜¯ç¡¬éœ€æ±‚ï¼›æˆ–è€…è€ƒè™‘è½»èŠ‚ç‚¹ `--syncmode=light`ã€‚

**Q4: ä¸€çº§é˜²ç«å¢™æ€ä¹ˆæ”¾ç«¯å£ï¼Ÿ**  
Aï¼šå¼€æ”¾ `30303 TCP/UDP` ç»™ P2Pã€`8545 TCP` ç»™ JSON-RPCï¼Œå…¶ä½™æŒ‰éœ€ã€‚

**Q5: å¦‚ä½•å‡çº§åˆ°æ–°ç‰ˆæœ¬ä¸ç¿»è½¦ï¼Ÿ**  
Aï¼šè€èŠ‚ç‚¹åœ `SIGINT` â†’ å¤‡ä»½æ•°æ® â†’ å®‰è£…æ–°ç‰ˆäºŒè¿›åˆ¶ â†’ åŒå‚æ•°å¯åŠ¨ï¼Œæ•°æ®å…¨ä¿ç•™ã€‚

---

## ç›‘æ§èŠ‚ç‚¹ï¼šè®©ä¸€åˆ‡å°½åœ¨æŒæ¡

æœ€ç®€å•ç»„åˆï¼š`Prometheus + Grafana`ï¼Œå®˜æ–¹ Exporter å·²å†…ç½®ï¼š

```bash
geth --metrics --metrics.addr 0.0.0.0 --metrics.port 6060
```

æŠ“å–ä»¥ä¸‹ Metricsï¼Œæ–°æ‰‹ä¼˜å…ˆæŸ¥çœ‹ï¼š

- `eth_syncing{stage="state",eta}`ï¼šå‘Šè¯‰ä½ è¿˜å‰©å¤šä¹…åŒæ­¥å®Œã€‚
- `p2p_peers`ï¼šå®æ—¶åœ¨çº¿å¯¹ç­‰èŠ‚ç‚¹æ•°é‡ã€‚
- `chain_head_block`ï¼šæœ¬åœ°æœ€é«˜å—é«˜ã€‚

å¦å¯æ­å»ºè„šæœ¬è½®è¯¢ `eth_blockNumber` è¿”å›å€¼å¼‚å¸¸æ—¶å‘é‚®ä»¶å‘Šè­¦ã€‚

---

## é«˜çº§ç©æ³•ï¼šå…±äº«èŠ‚ç‚¹ã€ç§ç½‘ä¸éªŒè¯è€…

1. **å…±äº«èŠ‚ç‚¹ RPC**ï¼šåœ¨ VPS ä¸Šéƒ¨ç½² Gethï¼Œå†é…åˆ `nginx` éªŒè¯å¯†é’¥å³å¯ç»™å†…éƒ¨ DApp è°ƒç”¨ã€‚
2. **ç§ç½‘æ­å»º**ï¼šæ”¹ä¸ªåˆ›ä¸– JSONï¼Œå¯åŠ¨åŒä¸€ä¸ª `NetworkId`ï¼Œå°±èƒ½è·‘ä¸€æ¡æµ‹è¯•é“¾ï¼Œç»™æ™ºèƒ½åˆçº¦æŒç»­é›†æˆç”¨ã€‚
3. **è´¨æŠ¼éªŒè¯è€…**ï¼š2025 ä¹‹åçš„ä»¥å¤ªåŠå·²æ˜¯ PoSï¼ŒGeth + Lighthouse ç»„åˆå¯æŠŠ Geth å½“æˆæ‰§è¡Œå±‚ï¼Œè·‘éªŒè¯è€…èŠ‚ç‚¹èµšè´¨æŠ¼æ”¶ç›Šã€‚

ğŸ‘‰ [å…è´¹è·å–éªŒè¯è€…è´¨æŠ¼æ”¶ç›Šè®¡ç®—å™¨ï¼Œå…ˆæµ‹ç®—å†è¡ŒåŠ¨](https://okxdog.com/)

---

## é•¿æœŸè¿ç»´ checklist

- æ¯å‘¨æ£€æŸ¥ SSD å‰©ä½™ç©ºé—´ï¼Œè¶…è¿‡ 85% è€ƒè™‘æ¢ç›˜æˆ–è½»èŠ‚ç‚¹ã€‚
- æœˆåº¦å‡çº§ Geth å°ç‰ˆæœ¬ï¼ŒYearly å‡çº§å¤§ç‰ˆæœ¬ï¼ˆç¡¬åˆ†å‰å‰å¿…é¡» UPï¼‰ã€‚
- å®šæœŸå¿«ç…§å¤‡ä»½ï¼šå°† `~/geth/chaindata` æ‰“åŒ…åˆ°å†·å¤‡ç¡¬ç›˜ + S3 åŒé‡ä¿é™©ã€‚
- ä½¿ç”¨ `systemd` ç®¡ç†è¿›ç¨‹ï¼Œé¿å…æ‰çº¿ï¼Œç¤ºä¾‹ unitï¼š

```
[Unit]
Description=Go Ethereum Node
After=network-online.target

[Service]
Type=simple
User=geth
ExecStart=/usr/local/bin/geth --config /home/geth/config.toml
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

---

## ç»“è¯­

æŒæ¡ Geth çš„è¿è¡Œé€»è¾‘åï¼Œä½ å·²å…·å¤‡å‚ä¸ä»¥å¤ªåŠä¸»ç½‘æ²»ç†ã€å¼€å‘ DeFi æ·±åº¦åˆ†æã€æˆ–æ¶è®¾ä¼ä¸šçº§ RPC ç½‘å…³çš„èƒ½åŠ›ã€‚åç»­å¯è¿›ä¸€æ­¥ç ”ç©¶ Besuã€Nethermind ç­‰å®¢æˆ·ç«¯çš„å¤šå®¢æˆ·ç«¯å†—ä½™æ–¹æ¡ˆï¼Œä¸ºèŠ‚ç‚¹å¯ç”¨æ€§å†ä¸Šä¿é™©ã€‚ä¿æŒæŒç»­å­¦ä¹ å’Œç›‘æ§ï¼Œæ˜¯è®©èŠ‚ç‚¹æ°¸ä¸ç¦»çº¿çš„å”¯ä¸€è·¯å¾„ã€‚
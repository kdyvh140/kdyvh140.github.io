---
layout:     post
title:      详解EIP-7706：2025年最新 Ethereum Gas 机制全景指南
date:       2025-09-05
header-img: img/post-bg-desk.jpg
catalog: true
---

关键词：EIP-7706、Ethereum Gas 模型、calldata、base fee、L2 成本、Rollup、Ethereum 收费机制、EIP-1559、EIP-4844、Blob Transaction、区块链扩容

---

## 回望：Ethereum Gas 的三次大升级

从「价高者得」的拍卖到三层阶梯式收费，Ethereum 的每一次 Gas 改革都是一次对 **扩容需求** 与 **经济激励** 的重新平衡。下面用简短的时序回顾这场「费用革命」：

| **时间点** | **升级/提案**     | **核心改变**                                                                |
|------------|-------------------|-----------------------------------------------------------------------------|
| 2021-08-05 | **EIP-1559**      | 将 Gas 费用拆分为「可预测的 base fee」与「灵活的 priority fee」，并销毁 base fee。 |
| 2024-03    | **EIP-4844**      | 引入 **Blob 数据** 与 **Blob Gas**，给 Rollup 单独开一条慢车道。            |
| 2024-05-13 | **EIP-7706**      | 把 **calldata 单独计价**，让 L2 进一步减负。                                |

## 当前场景：为什么还需要 EIP-7706？

虽然 EIP-4844 的 Blob 已经显著降低 Rollup 数据上链成本，但 **calldata 仍是隐形成本**。  
排序器依旧需要用 calldata 发送部分关键数据，当网络拥堵时：

- Congestion 将 base fee 抬到畸高，Rollup 每字节成本陡增。  
- 主网普通交易被大体积 calldata“挤出”，导致区块利用率下降。  

EIP-7706 的考虑是：**再给 calldata 量身定制一个独立市场**，就像 Blob 数据一样，避免交叉竞争。

## EIP-7706 机制深度拆解

### 1. 三级 Gas 赛道诞生

从“一条赛道竞速”调整为“三条赛道分摊”：

- **执行类 Gas**：EVM 操作的计算与存储费用。  
- **Blob 类 Gas**：2 MB 级的临时数据上链。  
- **calldata 类 Gas**：轻量级但高频的 L2 数据同步。  

通过将 calldata 从“执行类”剥离，开发者可以**独立预测并优化 L2 数据费用预算**。

### 2. 指数定价公式复用

沿用 EIP-4844 的指数函数：

```
base_fee_per_calldata_gas = MIN_BASE_FEE * e^(excess / SCALING_FACTOR)
```

- 当父区块使用的 calldata **超过目标**时，fee 加速上升；反之下跌。  
- 利用「滑点强烈」的指数曲线，抑制垃圾数据，保障主网的 **轻量通信**。

### 3. 新常量 LIMIT_TARGET_RATIOS

| 项目         | LIMIT_TARGET_RATIOS 下标 | 含义             |
|--------------|--------------------------|------------------|
| 执行类       | 0                        | 目标 50% 使用率 |
| Blob 类     | 1                        | 目标 50% 使用率 |
| calldata 类 | 2                        | 目标 25% 使用率 |

目前主网 Gas Limit 固定在 30 M，由此推算：

- calldata Gas target ≈ 1,875,000  
- 假设平均 10 Gas/字节，理论上可承载 **187.5 KB** calldata。

这个容量约为现有平均用量的 **2 倍**，既防阻塞，也避免资源浪费。

### 4. 降低 L2 成本的真实案例

某 ZK Rollup 每天有 2 GB 关键状态需要上链：

- 在 **EIP-4844 之前**：全部用 calldata，费用 ≈ 500+ USD/天。  
- 仅在 **EIP-4844 阶段**：改用 Blob + 部分 calldata，费用下降至 120 USD/天。  
- **加入 EIP-7706 之后**：calldata 量价双降，估算总成本再降 **35–45%**。  

👉 [查看一键评估 ETH 网络实时 Gas 动态工具，提前规划 Rollup 费用](https://okxdog.com/)

---

## FAQ：关于 EIP-7706 的六个疑惑

**Q1：calldata 和 Blob 可以同时用吗？**  
是的。L2 排序器可用 Blob 传输主体积数据，把 zk-Proof、状态根校验这些轻量但高频的信息放进 calldata 即可，两者互不抢占。

**Q2：普通主网用户会不会受影响？**  
日常转账、DeFi 交互基本无须 calldata，除非你的交易显式携带大量 `0x` 数据；绝大多数钱包已做 **自动优化**，不用担心费用飙升。

**Q3：指数函数会不会在极端场景把 calldata 费用抬到离谱？**  
指数曲线的「天花板」由参数 `SCALING_FACTOR` 与 `MIN_BASE_FEE` 决定，极端拥堵时仍会显著低于链上经济价值，矿工优先级更高的是执行交易而非 swamp calldata。

**Q4：是否意味着 Blob 价格会下降？**  
不一定。Blob 市场与 calldata 市场**完全隔离**，当 calldata 成本明显更低后，部分原本为了便宜而选 Blob 的小数据可能会切回 calldata，但这部分转换量极小，对 Blob fee 影响有限。

**Q5：Dapp 开发者需要改代码吗？**  
无需变动核心逻辑，只需确认 RPC 端返回的 **Gas Estimation** 已将 calldata 分离计价即可。多数节点客户端与 Infura、Alchemy 已完成适配。

**Q6：未来 calldata 容量还会继续扩展吗？**  
理论上能够通过 **软分叉调低** `CALLDATA_GAS_LIMIT_RATIO`、或 **提高全局 Gas Limit** 实现，但 EIP-7706 提案中没有明确定义时间表，需观察 **主网存储稳定性**。

---

## 数据可视：三次升级后的费用对比（2025 年主网数据快照）

- **单字节 calldata 的平均成本**  
  - EIP-1559 时代：约 0.00027 ETH（15 Gwei）  
  - EIP-4844 实施后：约 0.00005 ETH（2.8 Gwei）  
  - EIP-7706 主网稳定后：约 0.000018 ETH（1 Gwei）

- **Rollup TPS 提升数据**  
  - 2021：主流 L2 约 2–5 TPS  
  - 2024 Q1：平均 15 TPS（受 Blob 制约）  
  - 2025 Q2：平均 **35–50 TPS**（结合 7706，与 L2 压缩算法进一步演进）

👉 [感受一下「真·低费率」Rollup 互动体验，转账 0.05 USDT 仅需几分钱](https://okxdog.com/)

---

## 展望：Ethereum 的费用「三驾马车」趋于稳定

1. **执行层**：EVM 计算与存储，依旧通过传统 Base fee + Priority fee 调节。  
2. **数据层**：Blob + calldata 双管道，精准匹配 **大体量低频** 与 **小体量高频** 的需求。  
3. **共识层**：无需额外改动，PoS 奖励模型与销毁逻辑继续黏合供需两端。